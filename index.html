<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Phishow Scorecard v1</title>
  <style>
    body {
      font-family: 'Courier New', monospace;
      background-color: #000;
      color: #0f0;
      padding: 20px;
    }
    h1, h2 {
      color: #0ff;
    }
    select, button, input, textarea {
      font-family: inherit;
      font-size: 1em;
      background-color: #111;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 5px;
      margin-top: 10px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #0f0;
      padding: 5px;
      text-align: left;
    }
    th {
      background-color: #111;
    }
    .section {
      margin-top: 30px;
    }
    .instructions {
      border: 1px dashed #0f0;
      padding: 10px;
      margin-bottom: 30px;
    }
  </style>
</head>
<body>
  <h1>PHISHOW SCORECARD v1</h1>
  <p><strong>[SYS_MSG]</strong> Don't Suck at Phish</p>

  <div class="instructions">
    <h2>ðŸ“‹ Instructions</h2>
    <ol>
      <li>Select a show from the dropdown.</li>
      <li>Click <strong>Load Setlist</strong> to fetch real data.</li>
      <li>Rate each song using the dropdown (1â€“5).</li>
      <li>Add personal notes for standout moments.</li>
      <li>Reflect, revise, and remember: Donâ€™t Suck at Phish.</li>
    </ol>
  </div>

  <label for="showSelect">Choose a show:</label>
  <select id="showSelect">
    <option value="">Loading shows...</option>
  </select>
  <button onclick="loadShow()">Load Setlist</button>

  <div id="showDetails" class="section"></div>
  <div id="showNotes" class="section"></div>
  <div id="ratingGuide" class="section">
    <h2>Rating Guide</h2>
    <ul>
      <li>1 â€“ Poorly played, many flubs, band felt disconnected</li>
      <li>2 â€“ Standard bad version, played with moderate proficiency but little energy</li>
      <li>3 â€“ Standard version, the band did their job</li>
      <li>4 â€“ Standard great version, great energy, well played</li>
      <li>5 â€“ THE BEST VERSION EVER</li>
    </ul>
  </div>
  <div id="setlistRatings" class="section"></div>

  <script>
    const apiKey = "10645D7F59011FFA82A"; // Your actual Phish.net API key
    const showSelect = document.getElementById("showSelect");
    const showDetails = document.getElementById("showDetails");
    const showNotes = document.getElementById("showNotes");
    const setlistRatings = document.getElementById("setlistRatings");

    async function fetchShows() {
      try {
        const response = await fetch(`https://api.phish.net/v5/shows/artist/phish.json?order_by=showdate&limit=500&apikey=${apiKey}`);
        const data = await response.json();
        showSelect.innerHTML = '<option value="">Select a show</option>';
        data.data.forEach(show => {
          const option = document.createElement("option");
          option.value = show.showid;
          option.textContent = `${show.showdate} â€“ ${show.venue}`;
          showSelect.appendChild(option);
        });
      } catch (error) {
        console.error("Error fetching shows:", error);
        showSelect.innerHTML = '<option value="">Failed to load shows</option>';
      }
    }

    async function loadShow() {
      const showId = showSelect.value;
      if (!showId) return;

      try {
        const response = await fetch(`https://api.phish.net/v5/shows/showid/${showId}.json?apikey=${apiKey}`);
        const data = await response.json();
        const show = data.data[0];
        const setlistdata = show.setlistdata || "";

        // Show Details
        showDetails.innerHTML = `
          <h2>Show Details</h2>
          <p><strong>Date:</strong> ${show.showdate}</p>
          <p><strong>Venue:</strong> ${show.venue}</p>
          <p><strong>Location:</strong> ${show.city}, ${show.state}, ${show.country}</p>
        `;

        // Show Notes
        showNotes.innerHTML = `
          <h2>Show Notes</h2>
          <p>${show.setlistnotes || "No notes available for this show."}</p>
        `;

        // Parse setlist into songs
        const songs = setlistdata
          .split(/,|\n|>/)
          .map(s => s.trim())
          .filter(s => s.length > 0);

        // Setlist & Ratings
        let tableHTML = `
          <h2>Setlist & Ratings</h2>
          <table>
            <tr>
              <th>#</th>
              <th>Song</th>
              <th>Rating</th>
              <th>Notes</th>
            </tr>
        `;

        songs.forEach((song, index) => {
          tableHTML += `
            <tr>
              <td>${index + 1}</td>
              <td>${song}</td>
              <td>
                <select>
                  <option value="">--</option>
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="4">4</option>
                  <option value="5">5</option>
                </select>
              </td>
              <td><textarea rows="1" placeholder="Add notes..."></textarea></td>
            </tr>
          `;
        });

        tableHTML += "</table>";
        setlistRatings.innerHTML = tableHTML;

      } catch (error) {
        console.error("Error loading show:", error);
        showDetails.innerHTML = "<p>Failed to load show details.</p>";
        showNotes.innerHTML = "";
        setlistRatings.innerHTML = "";
      }
    }

    fetchShows();
  </script>
</body>
</html>
